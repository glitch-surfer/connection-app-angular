# Connections project with real backend

Welcome to the last level of the education journey. We hope this training lesson will enhance and
strengthen your knowledge and skills to design application structure and use entire framework power
solving the issues.

This project is intended for individual performance using the real one-for-all server. You can check
out your colleagues with their progress and be faster and more productive, because everyone should
have the same functionality.

> [!NOTE]
> Application aims to improve your technical skills. You are not limited in appearance, the main
> thing is for all features to be implemented and maximum user-friendly! It means, you have to
> **come up with yours design** of the app!

## General point

Single server provides sharing data and all students can interact with it reading and writing other
data. Each student's frontend project must be **identical in functionality** and any student opening
another student's project should have the same capabilities.

## Limitations

- all users are located in different timezones. Server keeps date and time
  in [UNIX timestamp](https://www.unixtimestamp.com/) format (as number), but you have care about
  appropriate timezone for everyone.
- server does not contain sufficient protection, for learning purpose we cut cumbersome redundant
  processes in order to focus on crucial features. Do not try to break it but inform us if you find
  critical defects.
- all transmitted data is **public** including personal email and messages. Do not use any sensitive
  data.
- server may have restrictions or limitations in data response if DB contains a lot of records. We
  are sincerely asking you to use it only to make sure the application works but do not overuse it
  for fun.

---

# Angular Application

The initial application can be generated by `@angular/cli`. Also, we recommend to use standalone
approach.

You can use additional package with visual components (to simplify and speed up the development):

- [Angular Material](https://material.angular.io/)
- [NGX Bootstrap](https://valor-software.com/ngx-bootstrap/#/documentation)
- [NG Bootstrap](https://ng-bootstrap.github.io/#/home)
- [PrimeNG](https://primeng.org/installation)
- [Taiga UI](https://taiga-ui.dev/getting-started)

You may also need [NgRx](https://ngrx.io/guide/store) for production. You are free to utilize any
development packages (
eslint, [husky](https://typicode.github.io/husky/), [prettier](https://prettier.io/docs/en/) etc.)
that are installed in `devDependencies` to aid in application construction but usage of any
additional production packages is prohibited!

We encourage you to use `ChangeDetectionStrategy.OnPush` strategy in components instead
of `Default`.

As a result application is supposed to use real backend and be deployed to any public host-provider
to make your project reachable. Also, the source of your project should be pushed to school
repository to allow any other student check it out.

> [!Warning]
> In the root README.md file of your project a brief description should be defined what
> milestones were made and the link to deployed running version! Otherwise, other student will not be
> able to verify your application.

## Milestones

Application represents the platform to allow users to communicate via public text messages. Before
starting to use the service a guest must register and sign in, after that all http-requests have to
contain `rs-email`, `rs-uid` and `Authorization` headers.

Authorized user can see vertically divided main page, where left side is a list of public group and
right side is a list of people including personal conversations. Each user can create own public
group and broadcast messages there or use existing group along with other participants.

Personal information can be viewed on a special profile page, where it can be immediately edited.

Detailed information about each part of the application is presented in the sections:

1. [Registration](./milestone_1.registration.md) 60 points
2. [Login](./milestone_2.login.md) 70 points
3. [Profile](./milestone_3.profile.md) 40 points
4. [Update profile](./milestone_4.profile_update.md) 55 points
5. [Logout](./milestone_5.logout.md) 40 points
6. [People and group sections](./milestone_6.people_groups.md) 175 points
7. [Group dialog](./milestone_7.group_dialog.md) 140 points
8. [People conversation](./milestone_8.conversation.md) 140 points
9. [404 page](./milestone_9.404_page.md) 30 points
10. Bonus: [Style theme](./milestone_10.theme.md) 50 points

Total score: **800 points**

## Examination

Each milestone has relative score. Each milestone has number of points for successful result.

> [!WARNING]
> All functionality and all requirements should be met even if user reload(refresh) any page in any
> time!  
> During the cross-check session you can try to refresh any page and validate requirements again.

But in case if some common violation is present the project is losing **additional** points:

#### During Cross-Check

- any uncaught runtime errors: **-100 points** for an error(s) in console.  
  _Explanation_: 400/500 http-error messages could appear in the console, but if it was handled and
  UI displayed some message, notification or made any other communication to the user what is
  happening - that is not the reason to deduct the points from the student.

#### Final conclusion

Restrictions on additional packages cannot be verified by students. This condition will be further
tested for students who score more than half of the points. If a student violates this condition,
the project scores will be nullified.

- used any production npm-package (except NgRx and 1 library with visual
  components): **-800 points**

## Url navigation

#### Guest

Pages available only for users before authorization. That pages are not available for users after
successful authorization and protected by _Guards_.

_`/signup` (registration)_  
Page to create new account.

_`/signin` (login)_  
Page where user can enter email and password to enter the platform. **Default page** for
non-authorized users.

#### Member

That pages allowed only for authorized users. Should be protected by _Guards_.

_`/` (main page)_  
Page with group list and people list.**Default page** for authorized users.

_`/profile` (user profile)_  
User's information with the ability to edit it.

_`/group/{:groupID}` (broadcast page)_  
where, `:groupID` is unique group identifier;  
Page where user can send message to all participants.

_`/conversation/{:conversationID}` (person dialog)_  
where, `:conversationID` is unique room identifier with interlocutor;
Page where user can write personal messages directly.

## Declarations

### Toast

It is a discrete and ephemeral notification presented to users on a graphical user interface.
conveys concise information, notifications, or feedback in a visually unobtrusive manner. These
messages are designed to appear momentarily and autonomously vanish without necessitating user
intervention, thereby minimizing disruption to the user's ongoing tasks.

The nomenclature "toast" in this context draws an analogy from the culinary practice where a toaster
pops up, signifying the completion of the toasting process. Analogously, a toast message emerges on
the user interface, delivering pertinent information and subsequently dissipating after a brief
period.

In various graphic packages, this element is denoted by distinct
names: [Snackbar](https://material.angular.io/components/snack-bar/overview) in Angular
Material, [Toast](https://ng-bootstrap.github.io/#/components/toast/overview) in NG
Bootstrap, [Toast](https://primeng.org/toast) in
PrimeNG, [Push](https://taiga-ui.dev/components/push) in Taiga UI, or you
can [make the component](https://medium.com/geekculture/simple-toast-notification-in-angular-f018b9aa3dc8)
yourself.

## Milestone 1. Registration

**Score:** 60

Before user be accessed it should be saved in the system.
Registration page should be on specific routing `/signup`.

User have to be redirected to the [Sign-In](./milestone_2.login.md) page after successful registration.

### Visualization

Page consist of:

**reactive form** with:

- first name field; Validation: required, allowed only letters (any language) or spaces, maximum 40
  characters;
- email field; Validation: required, email type;
- password field; Validation: required, minimum 8 symbols that include at least 1 capital letter, at
  least 1 digit and at least 1 special symbol;

**submit button**  
Triggers the process of registration. Any errors during the registration should be displayed to let
use know about the problem.

**link to Sign In page**  
If user already have an account he is able to login.

### Endpoint

> `POST` https://tasks.app.rs.school/angular/registration

#### Request body

| Parameter  | Type     | Description            |
| ---------- | -------- | ---------------------- |
| `email`    | `string` | email address of user  |
| `name`     | `string` | first name             |
| `password` | `string` | authorization password |

#### Response

_status code_ **201**

#### Exception

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Form data should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Parameters \"email\", \"name\" and \"password\" are required"
}
```

###### User already exists in the platform

_status code_ **400**

```json
{
  "type": "PrimaryDuplicationException",
  "message": "User {email} already exists"
}
```

## Examination

_Submit_ word is just the name of the button, you can use whatever label for the button you want.

### Profit

- page with dedicated url: **5 points**
- validation for _name_ and _email_ fields with error messages: **5 points**
- validation for _password_ field with error messages: **5 points**
- redirection to sign-in page after successful registration: **5 points**
- [toast messages](./README.md#toast) with appropriate text are displayed if http-request fails or
  succeed: **10 points**
- _Submit_ button is disabled if form is invalid. Also, it should be disabled after http error with
  type `PrimaryDuplicationException` until the user changes the field value: **10 points**
- _Submit_ button is disabled and `email` field has error message of taken account if user type the
  same email address that he tried to send before and got
  an error `PrimaryDuplicationException`: **10 points**
- _Submit_ button is disabled after clicking while http-request is in progress: **10 points**

### Fines

- redirection to sign-in page after failed registration: **-20 points**
- user can click _Submit_ button more than once even if previous http-request
  is not completed: **-20 points**

## Milestone 2. Login

**Score:** 70

If user with certain email was signed up, he can enter the system using login form.
It should be **default page** if user is not authenticated yet!

As a result of http-request application accept `token` and `uid` value to use it for further
http-requests.

> [!IMPORTANT]
> If authorization was made at other tab or other browser and new token was generated, the new token
> remains primary and old token will no longer valid!

Processing the successful response the value `token`, `uid` supposed to be persisted in browser's
local storage to use it in interceptors for all http-requests.

> User is considered as authorized if `token`, `uid` and `email` are persisted in `localStorage`.

Login page should be on specific routing `/signin`.

### Visualization

Page consist of:

**reactive form** with:

- email field; Validation: required, email type;
- password field; Validation: required;

**submit button**  
Triggers the process of authorization. Any errors during the registration should be displayed to let
use know about the problem.

**link to [Sign-Up](./milestone_1.registration.md) page**  
If user does not have account yet.

### Endpoint

> `POST` https://tasks.app.rs.school/angular/login

#### Request body

| Parameter  | Type     | Description            |
| ---------- | -------- | ---------------------- |
| `email`    | `string` | email address of user  |
| `password` | `string` | authorization password |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "token": "string",
  "uid": "string"
}
```

#### Exceptions

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Form data should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Parameters \"email\" and \"password\" are required."
}
```

###### User is not found

_status code_ **400**

```json
{
  "type": "NotFoundException",
  "message": "Email and/or password doesn't exist in the system."
}
```

## Examination

_Submit_ word is just the name of the button, you can use whatever label for the button you want.

### Profit

- default page for unauthorized user: **10 points**
- validation for _email_ field with error messages: **5 points**
- validation for _password_ field with error messages: **5 points**
- redirection to the main page after successful authentication: **10 points**
- [toast messages](./README.md#toast) with appropriate text are displayed if http-request fails or
  succeed: **10 points**
- _Submit_ button is disabled if form is invalid. Also, it should be disabled after http error with
  type `NotFoundException` until the user changes `email` or `password` field value: **10 points**
- _Submit_ button is disabled after clicking while http-request is in progress: **10 points**
- `token`, `uid` and `email` value is saved in `localStorage` after successful sign in and used
  again in the following http-requests even after page reloading (it allows user to omit
  sign in again after page reloading): **10 points**

### Fines

- redirection to any page after failed login: **-20 points**
- user can click _Submit_ button more than once even if previous http-request
  is not completed: **-20 points**

  ## Milestone 3. Profile

**Score:** 40

Information on this page should be loaded **only once** when user visit this page first time.

### Visualization

Page with certain routing `/profile` should contain:

- user id
- email address
- human-readable profile creation time
- user name

### Endpoint

> `GET` https://tasks.app.rs.school/angular/profile

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "email": {
    "S": "string" // user email
  },
  "name": {
    "S": "string" // user name
  },
  "uid": {
    "S": "string" // user id
  },
  "createdAt": {
    "S": "string" // unix timestamp in milliseconds when profile was created
  }
}
```

#### Exceptions

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### User is not found

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "User was not found"
}
```

## Examination

### Profit

- `user id`, `email`, `creation time`, `user name` data of current user is displayed
  on the page: **30 points**
- error message with appropriate text are displayed on the page if loading http-request fails
  (for instance, if internet connection is lost): **10 points**

### Fines

- `/profile` http-request is sent every time if user opens profile page: **-15 points**

## Milestone 4. Profile updating

**Score:** 55

User can change and save his name. Application **should not** perform _get_ http-request `/profile`
again to retrieve saved data, if _put_ http-request succeed the data from the form is applied to
Profile page instantly.

### Visualization

The button _Edit_ should be present on the page. Clicking on the button field `name` becomes
editable, _Save_ button appears to save new data on the server via http-request, _Cancel_ button
appears to revert back state to static form without modifications.

_Save_ button is disabled (or is not visible) while http-request is sent and other updating
processes are in progress to prevent clicking the button multiple times in a row.  
_Cancel_ button is disabled (or is not visible) while http-request is sent and other updating
processes are in progress to prevent editing from being canceled if the updating process is already
running.

Form field `name` should obey the same validation rules as
on [Registration page](./milestone_1.registration.md).

### Endpoint

> `PUT` https://tasks.app.rs.school/angular/profile

Edit profile data of current user.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request body

| Property | Type     | Description   |
| -------- | -------- | ------------- |
| `name`   | `string` | new user name |

#### Response

_status code_ **201**

#### Exceptions

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Form data should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "You have to pass \"name\" field."
}
```

###### User cannot be found by passed parameters

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "User was not found. Check passed identificators."
}
```

## Examination

### Profit

- button _Edit_ makes `name` field editable: **10 points**
- button _Cancel_ returns initial page state (static appearance): **5 points**
- clicking the button _Save_ sends 1 http-request to save new data without the ability to click it
  again (along with _Cancel_ button) until process is end: **20 points**
- buttons _Cancel_ and _Save_ are visible ony for editable form: **5 points**
- button _Edit_ is visible only for static page: **5 points**
- [toast messages](./README.md#toast) with appropriate text are displayed if http-request fails or
  succeed: **10 points**

### Fines

- http-request `/profile` to retrieve profile data is sent: **-20 points**
- edited data is applied to the static Profile page even if http-request fails: **-20 points**

## Milestone 5. Logout

**Score:** 40

User can terminate current session. Successful sign out process removes token for
http-request and application should wipe out all relative browser
data (`localStorage` | `sessionStorage` | `cookies`).

If action succeed user supposed to be redirected into [Login page](./milestone_2.login.md).

### Visualization

Special button `Logout` should be places on the [Profile page](#milestone-3-profile) in the top
right corner.
Button can be pressed once and button should be disabled until previous http-request is completed.

### Endpoint

> `DELETE` https://tasks.app.rs.school/angular/logout

Removes session data for the user.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Response

_status code_ **200**

#### Exceptions

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Passed token is invalid

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Current session token is not valid."
}
```

## Examination

### Profit

- clicking on `Logout` button the http-request is sent
  with `DELETE` method: **10 points**
- user is redirected to Sign-In page after successful logout process: **10 points**
- all data in `cookies`, `localStorage` is deleted: **10 points**
- [toast messages](./README.md#toast) with appropriate text are displayed if http-request fails or
  succeed: **10 points**

  ## Milestone 6. People & Groups

**Score:** 175

The **default page** for authorized user should be the one without extra path (root routing).
Page is split into 2 vertical sections.
Left side is [Group section](#milestone-61-group-list).
Right side is [People section](#milestone-62-people-list).

> [!WARNING]
> Please, do not use any timers or intervals to update Group or People list! Only manual triggers
> are allowed.

## Milestone 6.1. Group list

**Score:** 100

Each of users can observe all available groups to broadcast messages. There is no private groups!
Also, user can create new one that will be visible for all other users.

### Visualization

Left half of the primary page consist of:

**_Update_ button**  
_Update_ button refreshes the group list by sending http-request and renders obtained list.

User can update the list no more than once a minute! Countdown must be present near the _Update_
button till the next update is possible. If time is out countdown disappears.
This state should be preserved even after transition to other pages and back.

> [!NOTE]
> Countdown(timer) and disabled _Update_ button is applied only after clicking on _Update_ button.  
> First visit on the page should not have any effect on timer.

> [!NOTE]
> Countdown(timer) should display the actual number of seconds remaining until the end of one minute
> after the _Update_ button is pressed, even if the user navigates across pages. That is, if the user
> presses the _Update_ button, goes to other pages, and returns to the list page after 35 seconds, he
> should see the timer showing 25, 24, 23...

**_Create_ button**  
_Create_ button opens modal window with a reactive form where user can enter `name`. Using
endpoint (below) application creates new group and append it into the list **without** retrieving
all group list with http-request again.

Form validation:

- `name` is not more than 30 symbols;
- `name` contains only letters, digits or spaces;

**List of groups**  
Simple list with **clickable items as a link** and extra delete button at the right of the name for
the groups were created by current user.

Clicking on item user is redirected to dedicated page with routing `/group/{:groupID}`

Confirmation modal window appears after clicking on delete group icon. If confirmation was accepted
using http-request the group is deleted and group is being removed from the list **without**
obtaining all group list with http-request again.

_rough example of group list_:  
`---------------------------------`  
`|` Someone's Group name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`---------------------------------`  
`|` My Group
name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#10006; `|`  
`---------------------------------`  
`|` Someone's Group name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`---------------------------------`

### Endpoint

> `GET` https://tasks.app.rs.school/angular/groups/list

Retrieves list of available groups which can be used to broadcast messages.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "Count": "number",
  "Items": [
    {
      "id": {
        "S": "string" // group id
      },
      "name": {
        "S": "string" // group name
      },
      "createdAt": {
        "S": "string" // unix timestamp when group was created
      },
      "createdBy": {
        "S": "string" // user id who created this group
      }
    }
    // ... another object in the same format
  ]
}
```

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

---

> `POST` https://tasks.app.rs.school/angular/groups/create

Creates new group with specific name. Owner will be able to delete created group.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request body

| Property | Type     | Description    |
| -------- | -------- | -------------- |
| `name`   | `string` | new group name |

#### Response

_status code_ **201**  
_json_ format

```json
{
  "groupID": "y5kse1rcgh"
}
```

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Form data should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Parameter \"name\" should define conversation name."
}
```

---

> `DELETE` https://tasks.app.rs.school/angular/groups/delete?groupID={:groupID}

Deletes group by owner.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request query

| Parameter | Type     | Description             |
| --------- | -------- | ----------------------- |
| `groupID` | `string` | unique group identifier |

#### Response

_status code_ **200**

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Query string should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "\"groupID\" parameter should be in query list."
}
```

###### Group does not exist

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "Group with id \"${groupID}\" does not exist or was removed before."
}
```

## Milestone 6.2. People list

**Score:** 60

User can observe all list of registered participants and make the individual conversation with any
of them.

There are 2 endpoints:

_/users_  
Retrieves list of all registered is the system participants. This list should be rendered excluding
yourself.

_/conversations/list_  
Retrieves list of active individual conversations with unique id. This list used to mark list items
with special color and not to re-create already existing conversation.

### Visualization

Right half of the primary page consist of:

**_Update_ button**  
_Update_ button refreshes the people list by sending http-request and renders obtained list.

User can update the list no more than once a minute! Countdown must be present near the _Update_
button till the next update is possible. If time is out countdown disappears.
This state should be preserved even after transition to other pages and back.

> [!NOTE]
> Countdown(timer) and disabled _Update_ button is applied only after clicking on _Update_ button.  
> First visit on the page should not have any effect on timer.

> [!NOTE]
> Countdown(timer) should display the actual number of seconds remaining until the end of one minute
> after the _Update_ button is pressed, even if the user navigates across pages. That is, if the user
> presses the _Update_ button, goes to other pages, and returns to the list page after 12 seconds, he
> should see the timer showing 48, 47, 46...

**List of people**  
Simple list with **clickable items as a link** of all members. If user has the conversation with
someone
created earlier, its list item should have different background light color.

Clicking on item user is redirected to dedicated page with
routing `/conversation/{:conversationID}`.

> [!WARNING]
> Technically application should create conversation via special http-request (below) before user is
> redirected to the dialog page if there is no
> already created conversation with unique id. If any errors occur during conversation creation user
> have to see [toast](./README.md#toast) danger message and redirection should be canceled.

_rough example of people list_:  
`-----------------------`  
`|`
Sofía&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`-----------------------`  
`|`
Nicolás&nbsp;&nbsp;`*********`&nbsp; `|`  
`-----------------------`  
`|`
Mateo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`-----------------------`

### Endpoint

> `GET` https://tasks.app.rs.school/angular/users

Retrieves list of participants.

_You can use this endpoint only once during 1 browser session (until the user refreshes the page)._

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "Count": "number",
  "Items": [
    {
      "name": {
        "S": "string" // user name
      },
      "uid": {
        "S": "string" // user id
      }
    }
    // ... another object in the same format
  ]
}
```

#### Exceptions

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

---

> `GET` https://tasks.app.rs.school/angular/conversations/list

Retrieves list of active conversations of current user.

_You can use this endpoint only once during 1 browser session (until the user refreshes the page)._

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "Count": "number",
  "Items": [
    {
      "id": {
        "S": "string" // conversation id
      },
      "companionID": {
        "S": "string" // conversation parter's id
      }
    }
    // ... another object in the same format
  ]
}
```

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

---

> `POST` https://tasks.app.rs.school/angular/conversations/create

Creates conversation with the user.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request body

| Property    | Type     | Description     |
| ----------- | -------- | --------------- |
| `companion` | `string` | user identifier |

#### Response

_status code_ **201**  
_json_ format

```json
{
  "conversationID": "string"
}
```

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Companion identifier is not defined

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Parameter \"companion\" should be defined."
}
```

###### Conversation already exist

_status code_ **400**

```json
{
  "type": "DuplicationNotAllowedException",
  "message": "Conversation already exists."
}
```

## Examination

### Profit

- default page for authorized user: **10 points**
- page is divided on 2 vertical sections with independent content: **5 points**

#### Group section (left)

- the list of available groups is loaded if user opens this page first time: **5 points**
- the list item created by current user should contain _Delete_ button: **10 points**
- the confirmation modal appears after clicking on _Delete_ button on list item with _Cancel_,
  _Delete_ button inside. If user clicks _Cancel_ the modal disappears. If user clicks _Delete_ the
  http-request is sent and item is removed from the list after succeeded response: **15 points**
- clicking on _Update_ button sends corresponding http-request and update group
  list if succeeded: **10 points**
- countdown appears for 1 minute after clicking on _Update_ button
  (except if error occurs): **10 points**
- _Update_ button is disabled after clicking during updating and until the timer
  is active: **5 points**
- clicking on _Create_ button the modal window is opened. There is form with validation and
  submit button: **10 points**
- submit button in modal window should be disabled until form is valid: **5 points**
- clicking on submit button in modal window the appropriate http-request is sent to create new
  group. Modal window is closed only if http-request succeeded: **15 points**
- [toast messages](./README.md#toast) with appropriate text are displayed if http-request fails or
  succeed: **10 points**
- clicking on list item the user is redirected to group dialog page: **5 points**

#### People list (right)

- the list of people is loaded if user opens this page first time: **10 points**
- the list item with which current user already has active conversation has
  special background: **10 points**
- clicking on _Update_ button sends corresponding http-request and update people list
  if succeeded: **10 points**
- countdown appears for 1 minute after clicking on _Update_ button
  (except if error occurs): **10 points**
- _Update_ button is disabled after clicking during updating and until the
  timer is active: **5 points**
- clicking on list item the user is redirected to personal conversation page. New conversation (via
  certain http-request) is created if it has not already created before transition: **15 points**

### Fines

#### Group section

- list of groups via `/groups/list` is automatically loaded more than once during 1 browser
  session (until the user refreshes the page) if user do not click _Update_ button. For instance,
  when user navigates through the pages, sends new messages, deletes or creates
  group(s): **-30 points**

#### People list

- list of conversations via `/conversations/list` is automatically loaded more than once during 1
  browser session (until the user refreshes the page) if user do not click _Update_ button. For
  instance, when user navigates through the pages, sends new messages, deletes or creates
  conversation(s): **-20 points**
- list of users via `/users` is automatically loaded more than once during 1 browser session (until
  the user refreshes the page) if user do not click _Update_ button. For instance, when user
  navigates through the pages, sends new messages, deletes or creates
  conversation(s): **-20 points**

  ## Milestone 7. Group dialog

**Score:** 140

Before user can send any message in the public dialog the channel should exist or has to be created
with `/groups/create` endpoint.

### Visualization

Page with dedicated routing `/group/{:groupID}` consist of:

**Return back link**  
It should be the link(!) to navigate to primary page.

**_Update_ button**  
Clicking on _Update_ button the application should send http-request, process the response and
display new messages if they are.

This button can be pressed once a minute and _Update_ button should be disabled! Countdown is
supposed to indicate how much time left. Countdown disappears when time is out.

> [!NOTE]
> Countdown(timer) and disabled _Update_ button is applied only after clicking on _Update_ button.  
> First visit on the page should not have any effect on timer.

> [!NOTE]
> Countdown(timer) should display the actual number of seconds remaining until the end of one minute
> after the _Update_ button is pressed, even if the user navigates across pages. That is, if the user
> presses the _Update_ button, goes to other pages, and returns to the list page after 58 seconds, he
> should see the timer showing 2, 1, _(disappear)_

**_Delete_ button**  
Visible only for group owner.
Clicking on this button the group will be deleted and people will not be able to sent messages.

**Area with messages**  
Section displays all messages. Own messages should be on the right side. The messages from other
people should be aligned to the left side.

Each message item with your appearance is supposed to consist of:

- date/time the message was created
- user name
- message text

`-----------------------------`  
`|` 2023/10/17 3:54
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`|` John
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`|` My new message
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`-----------------------------`  
`|` &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2023/10/17 5:18 `|`  
`|`
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me `|`  
`|` &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; My new
message `|`  
`-----------------------------`

**Form field for new message**  
Simple form field with _text_ type for new message + _Send_ button to trigger process.

### Technical solution

All received message data should be organized in a way that prevents loading of old(previous)
messages again if user navigates between pages and returns back to the channel until browser is
reloaded.

Corresponding endpoint can receive optional query parameter `since`.
If parameter is omitted - all messages are responded. That option should be when user visit group
first time.  
Every subsequent group update the `since` parameter supposed to be set to the last received message
unix time
and only new messages (after that time) will be responded. Application should get only new messages
and append them to the list.

### Endpoint

> `GET` https://tasks.app.rs.school/angular/groups/read?groupID={:groupID}&since={:since}

Retrieves messages of provided group.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request query

| Parameter | Type     | Description                               |
| --------- | -------- | ----------------------------------------- |
| `groupID` | `string` | unique group identifier                   |
| `since`   | `number` | (Optional) unix timestamp in milliseconds |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "Count": "number",
  "Items": [
    {
      "authorID": {
        "S": "string" // id of the author of the message
      },
      "message": {
        "S": "string" // message text
      },
      "createdAt": {
        "S": "string" // unix timestamp when message was sent
      }
    }
    // ... other objects in the same format
  ]
}
```

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Query string should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "\"groupID\" parameter should be in query list."
}
```

###### Group does not exist

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "Group with id \"{groupID}\" does not exist or was removed before."
}
```

---

> `POST` https://tasks.app.rs.school/angular/groups/append

Sends new message into the group channel.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request body

| Property  | Type     | Description           |
| --------- | -------- | --------------------- |
| `groupID` | `string` | group identifier      |
| `message` | `string` | personal message text |

#### Response

_status code_ **201**

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Form data should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidPostData",
  "message": "Post data should contain valid \"groupID\", \"message\" parameters."
}
```

###### Conversation is not ready to be used

_status code_ **400**

```json
{
  "type": "RoomReadyException",
  "message": "Group with id \"{groupID}\" seems not ready yet"
}
```

###### Group does not exist

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "Group with id \"{groupID}\" does not exist or was removed before."
}
```

## Examination

### Profit

- the page is protected by a guard only for authorized user: **5 points**
- the error message is displayed if group with provided id does not exist: **10 points**
- _Return back_ is a link, not a button: **5 points**
- the full message history is loaded if user visit this page first time: **10 points**
- only the last messages (using `since` parameter) are loaded if user opens this group conversation
  again: **20 points**
- only the last messages (using `since` parameter) are loaded if user clicks on
  _Update_ button: **20 points**
- messages in corresponding area are sorted by time. New messages are appended at
  the bottom: **5 points**
- message item contains readable time, user name and text. Own messages are displayed on the right.
  Other messages are displayed on the left: **10 points**
- countdown appears for 1 minute after clicking on _Update_ button
  (except if error occurs): **10 points**
- _Update_ button is disabled after clicking during updating and until the
  timer is active: **5 points**
- group is created by current user should contain _Delete_ button: **10 points**
- the confirmation modal appears after clicking on _Delete_ button with _Cancel_,
  _Delete_ button inside. If user clicks _Cancel_ the modal disappears. If user clicks _Delete_ the
  http-request is sent and the user is redirected to main page after succeeded
  response: **10 points**
- form field has `required` validator. _Send new message_ button is disabled until field
  has text: **5 points**
- new messages are loaded (using `since` parameter) after successful sending
  new message: **15 points**

### Fines

- _Delete_ button is not present on the page for own group after hard page
  reloading(refreshing): **-20 points**
- while user is on this dialog page, he reloads the page and navigates to the main page.
  Http-request to `/groups/list` is sent more than once: **-25 points**

  ## Milestone 8. Person conversation

**Score:** 140

Before user can send any message to other participant the conversation should exist or has to be
created with `/conversations/create` endpoint.

### Visualization

Page with dedicated routing `/conversation/{:conversationID}` consist of:

**Return back link**  
It should be the link(!) to navigate to primary page.

**_Update_ button**  
Clicking on _Update_ button the application should send http-request, process the response and
display new messages if they are.

This button can be pressed once a minute and _Update_ button should be disabled! Countdown is
supposed to indicate how much time left. Countdown disappears when time is out.

> [!NOTE]
> Countdown(timer) and disabled _Update_ button is applied only after clicking on _Update_ button.  
> First visit on the page should not have any effect on timer.

> [!NOTE]
> Countdown(timer) should display the actual number of seconds remaining until the end of one minute
> after the _Update_ button is pressed, even if the user navigates across pages. That is, if the user
> presses the _Update_ button, goes to other pages, and returns to the list page after 23 seconds, he
> should see the timer showing 37, 36, 35...

**_Delete_ button**  
Clicking on this button the conversation will be deleted and the partner will not be able to sent
messages until conversation is created again. All messages are being deleted.

**Area with messages**  
Section displays all messages. Own messages should be on the right side. The messages from other
people should be aligned to the left side.

Each message item with your appearance is supposed to consist of:

- date/time the message was created
- user name
- message text

`-----------------------------`  
`|` 2023/10/17 3:54
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`|` John
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`|` My new message
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `|`  
`-----------------------------`  
`|` &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2023/10/17 5:18 `|`  
`|`
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Me `|`  
`|` &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; My new
message `|`  
`-----------------------------`

**Form field for new message**  
Simple form field with _text_ type for new message + _Send_ button to trigger process.

### Technical solution

All received message data should be organized in a way that prevents loading of old(previous)
messages again if user navigates between pages and returns back to the channel until browser is
reloaded.

Corresponding endpoint can receive optional query parameter `since`.
If parameter is omitted - all messages are responded. That option should be when user open
conversation first time.  
Every subsequent conversation update the `since` parameter supposed to be set to the last received
message unix time
and only new messages (after that time) will be responded. Application should get only new messages
and append them to the list.

### Endpoint

> `GET` https://tasks.app.rs.school/angular/conversations/read?conversationID=46f6aq96dzs&since=1699833375896

Received messages of provided conversation.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request query

| Parameter        | Type     | Description                               |
| ---------------- | -------- | ----------------------------------------- |
| `conversationID` | `string` | unique conversation identifier            |
| `since`          | `number` | (Optional) unix timestamp in milliseconds |

#### Response

_status code_ **200**  
_json_ format

```json
{
  "Count": "number",
  "Items": [
    {
      "authorID": {
        "S": "string" // id of the author of the message
      },
      "message": {
        "S": "string" // message text
      },
      "createdAt": {
        "S": "string" // unix timestamp when message was sent
      }
    }
    // ... other objects in the same format
  ]
}
```

### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Query string should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "\"conversationID\" parameter should be in query list."
}
```

###### Conversation does not exist

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "Conversation with id \"{conversationID}\" does not exist or was deleted before."
}
```

---

> `POST` https://tasks.app.rs.school/angular/conversations/append

Sends new message to the partner.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request body

| Property         | Type     | Description             |
| ---------------- | -------- | ----------------------- |
| `conversationID` | `string` | conversation identifier |
| `message`        | `string` | personal message text   |

#### Response

_status code_ **201**

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Sent form data is corrupted

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid multipart/form-data request"
}
```

###### Format of form data is unknown or cannot be read

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "Invalid post data"
}
```

###### Form data should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidPostData",
  "message": "Post data should contain valid \"conversationID\", \"message\" parameters."
}
```

###### Conversation is not ready to be used

_status code_ **400**

```json
{
  "type": "RoomReadyException",
  "message": "Conversation with id \"{conversationID}\" seems not ready yet"
}
```

###### Conversation does not exist

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "Conversation with id \"{conversationID}\" does not exist or was deleted before."
}
```

---

> `DELETE` https://tasks.app.rs.school/angular/conversations/delete?conversationID={:conversationID}

Deletes conversation with the interlocutor.

#### Request headers

| Header          | Type     | Description                                                                               |
| --------------- | -------- | ----------------------------------------------------------------------------------------- |
| `rs-uid`        | `string` | user identifier received after successful authentication                                  |
| `rs-email`      | `string` | user email                                                                                |
| `Authorization` | `string` | `Bearer <TOKEN>`, where `<TOKEN>` is token value received after successful authentication |

#### Request query

| Parameter        | Type     | Description                    |
| ---------------- | -------- | ------------------------------ |
| `conversationID` | `string` | unique conversation identifier |

#### Response

_status code_ **200**

#### Exception

###### Have not passed required headers in http-request

_status code_ **400**

```json
{
  "type": "InvalidUserDataException",
  "message": "Header should contain \"rs-uid\", \"rs-email\" and \"Authorization\" parameters."
}
```

###### Have not passed valid Authorization header parameter

_status code_ **400**

```json
{
  "type": "InvalidTokenException",
  "message": "Header should contain \"Authorization\" parameter with Bearer code."
}
```

###### Query string should contain required parameters

_status code_ **400**

```json
{
  "type": "InvalidFormDataException",
  "message": "\"conversationID\" parameter should be in query list."
}
```

###### Conversation does not exist

_status code_ **400**

```json
{
  "type": "InvalidIDException",
  "message": "Conversation with id \"{conversationID}\" does not exist or was removed before."
}
```

## Examination

### Profit

- the page is protected by a guard only for authorized user: **5 points**
- the error message is displayed if conversation with provided id does not exist: **10 points**
- _Return back_ is a link, not a button: **5 points**
- the full message history is loaded if user visit this page first time: **10 points**
- only the last messages (using `since` parameter) are loaded if user opens this group conversation
  again: **25 points**
- only the last messages (using `since` parameter) are loaded if user clicks on
  _Update_ button: **25 points**
- messages in corresponding area are sorted by time. New messages are appended at
  the bottom: **5 points**
- message item contains readable time, user name and text. Own messages are displayed on the right.
  Other messages are displayed on the left: **10 points**
- countdown appears for 1 minute after clicking on _Update_ button
  (except if error occurs): **10 points**
- _Update_ button is disabled after clicking during updating and until the
  timer is active: **5 points**
- the confirmation modal appears after clicking on _Delete_ button with _Cancel_,
  _Delete_ button inside. If user clicks _Cancel_ the modal disappears. If user clicks _Delete_ the
  http-request is sent and the user is redirected to main page after succeeded
  response: **10 points**
- form field has `required` validator. _Send new message_ button is disabled until field
  has text: **5 points**
- new messages are loaded (using `since` parameter) after successful sending
  new message: **15 points**

### Fines

- _Delete_ button is not present on the page hard page reloading(refreshing): **-15 points**
- while user is on this conversation page, he reloads the page and navigates to the main page.
  Http-request to `/conversations/list` or `/users` is sent more than once: **-25 points**

  ## Milestone 9. 404 page

**Score:** 30

For the occasion when user tries to open unknown page he should be informed about it with the
appropriate message.
Page url should not be changed.

### Visualization

Page is supposed to have:

- link to the primary page (depending on user authorization status)
- message about wrong url

## Examination

### Profit

- error message is displayed about wrong url/page: **30 points**

## Fines

- url is changed: **-20 points**

## Milestone 10. Dark/Light theme.

**Score:** 50

To allow user change the appearance of the site to improve visual perception in varying levels of
ambient lightning.

### Visualization

The special button should be placed in the site header.
_Light_ version is default, when user visit site first time.

The visual presentation of each page for dark/light state could be made on your own.

Current state of switcher should be persisted in `localStorage`. When user visit site again the last
chosen option supposed to be applied to the site.

### Solution

Independent components can have their own styles based on some inputs, for example, custom button
has `@Input() disabled = false;` property and contains styles for that state based on specific class
in html - `<button [class.disabled]="disabled"></button>`

`.dark`/`.light` class name is set to the root element in the main component depending on switcher
in the header. The `:host-context()` pseudo-class selector is used in component style files to apply
specific css theme rules to the elements.

Actually, it does not matter what approach you choose indeed, the most preferable option would be
not to use services or decorators for that.

## Examination

### Profit

- chosen state is saved in `localStorage` and used/applied after reloading. User can refresh the
  page and see the same theme: **20 points**
- light/dark styles are applied to main page: **10 points**
- light/dark styles are applied to group dialog page: **10 points**
- light/dark styles are applied to personal conversation page: **10 points**
