"use strict";(self.webpackChunkconnection=self.webpackChunkconnection||[]).push([[229],{5229:(I,u,i)=>{i.r(u),i.d(u,{ProfileComponent:()=>M});var c=i(6223),p=i(6814),l=i(2296),d=i(5940),t=i(9212),h=i(141);function x(e,s){1&e&&t._UZ(0,"mat-spinner",3)}function v(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(n),t.oxw();const o=t.MAs(4),r=t.oxw(3);return t.KtG(r.onEdit(o.textContent))}),t._uU(1," Edit "),t.qZA()}}function _(e,s){if(1&e&&(t.TgZ(0,"p"),t.YNc(1,v,2,0,"button",8),t._uU(2," name: "),t.TgZ(3,"span",null,9),t._uU(5),t.qZA()()),2&e){const n=t.oxw().ngIf,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!a.isEditable),t.xp6(4),t.Oqu(n.name)}}function P(e,s){1&e&&(t.TgZ(0,"p",14),t._uU(1,"Please enter name"),t.qZA())}function g(e,s){if(1&e&&(t.TgZ(0,"p",14),t._uU(1),t.qZA()),2&e){const n=t.oxw(4);t.xp6(1),t.AsE(" Maximum length is ",null==n.name.errors||null==n.name.errors.maxlength?null:n.name.errors.maxlength.requiredLength,", you entered ",null==n.name.errors||null==n.name.errors.maxlength?null:n.name.errors.maxlength.actualLength," ")}}function b(e,s){1&e&&(t.TgZ(0,"p",14),t._uU(1,"Only letters are allowed"),t.qZA())}function f(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"label",11),t._uU(2,"name: "),t.qZA(),t._UZ(3,"input",12),t.YNc(4,P,2,0,"p",13)(5,g,2,2,"p",13)(6,b,2,0,"p",13),t.BQk()),2&e){const n=t.oxw(3);t.xp6(3),t.Q6J("formControl",n.name),t.xp6(1),t.Q6J("ngIf",n.hasError("required")),t.xp6(1),t.Q6J("ngIf",n.hasError("maxlength")),t.xp6(1),t.Q6J("ngIf",n.hasError("pattern"))}}function m(e,s){if(1&e&&(t.TgZ(0,"div")(1,"p"),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.YNc(5,_,6,2,"p",4)(6,f,7,4,"ng-container",4),t.TgZ(7,"p"),t._uU(8),t.ALo(9,"date"),t.qZA()()),2&e){const n=s.ngIf,a=t.oxw(2);t.xp6(2),t.hij("id: ",n.uid,""),t.xp6(2),t.hij("email: ",n.email,""),t.xp6(1),t.Q6J("ngIf",!a.isEditable),t.xp6(1),t.Q6J("ngIf",a.isEditable),t.xp6(2),t.hij("created: ",t.lcZ(9,5,n.createdAt),"")}}function C(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.isEditable=!1)}),t._uU(1,"Cancel"),t.qZA()}}function O(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.onSave())}),t._uU(1,"Save"),t.qZA()}}function E(e,s){if(1&e&&(t.YNc(0,m,10,7,"div",4),t.ALo(1,"async"),t.TgZ(2,"div",5),t.YNc(3,C,2,0,"button",6)(4,O,2,0,"button",7),t.qZA()),2&e){const n=t.oxw();t.Q6J("ngIf",t.lcZ(1,3,n.profile$)),t.xp6(3),t.Q6J("ngIf",n.isEditable),t.xp6(1),t.Q6J("ngIf",n.isEditable)}}let M=(()=>{class e{constructor(n){this.profileService=n,this.name=new c.NI("",{validators:[c.kI.required,c.kI.maxLength(40),c.kI.pattern(/^[a-zA-Z\u0430-\u044f\u0410-\u042f ]+$/)]}),this.profile$=this.profileService.profile$,this.loading$=this.profileService.loading$,this.isEditable=!1}ngOnInit(){this.profileService.getProfile()}onEdit(n){n&&(this.isEditable=!0,this.name.setValue(n))}onSave(){this.name.invalid||!this.name.value||(this.isEditable=!1,this.profileService.updateProfileName(this.name.value))}hasError(n){return this.name?.touched&&this.name?.errors?.[n]}onLogout(){this.profileService.logout()}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(h.S))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-profile"]],standalone:!0,features:[t.jDz],decls:9,vars:7,consts:[["mat-flat-button","","color","secondary",1,"logout-btn",3,"disabled","click"],["class","spinner",4,"ngIf","ngIfElse"],["content",""],[1,"spinner"],[4,"ngIf"],[1,"btn-container"],["mat-flat-button","","color","secondary",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","color","secondary","class","edit-btn",3,"click",4,"ngIf"],["profileName",""],["mat-flat-button","","color","secondary",1,"edit-btn",3,"click"],["for","name"],["type","text","id","name","placeholder","name",1,"input",3,"formControl"],["class","error",4,"ngIf"],[1,"error"],["mat-flat-button","","color","secondary",3,"click"],["mat-flat-button","","color","primary",3,"click"]],template:function(a,o){if(1&a&&(t.TgZ(0,"h2"),t._uU(1,"Profile"),t.qZA(),t.TgZ(2,"button",0),t.NdJ("click",function(){return o.onLogout()}),t.ALo(3,"async"),t._uU(4,"Logout"),t.qZA(),t.YNc(5,x,1,0,"mat-spinner",1),t.ALo(6,"async"),t.YNc(7,E,5,5,"ng-template",null,2,t.W1O)),2&a){const r=t.MAs(8);t.xp6(2),t.Q6J("disabled",t.lcZ(3,3,o.loading$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(6,5,o.loading$))("ngIfElse",r)}},dependencies:[p.ez,p.O5,p.Ov,p.uU,c.UX,c.Fj,c.JJ,c.oH,l.ot,l.lW,d.Cq,d.Ou],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{background-color:#e3f2fd;font-family:Roboto,Helvetica Neue,sans-serif}body.dark-theme[_ngcontent-%COMP%]{background-color:#283593;color:#e3f2fd}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:visited{color:#3f51b5}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:visited:hover{opacity:.8}a[_ngcontent-%COMP%]:active, a[_ngcontent-%COMP%]:visited:active{opacity:.6}.dark-theme[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#e89126}.error-snackbar[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;color:#3f51b5;background-color:#e3f2fd;border-bottom:3px solid #ff0000}.success-snackbar[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;color:#3f51b5;background-color:#e3f2fd;border-bottom:3px solid #00ff00}button[_ngcontent-%COMP%]:disabled{color:#757575}.btn[_ngcontent-%COMP%]{height:36px;padding:0 1rem;align-self:flex-start;color:#fafafa;background-color:#424242;border-radius:4px;border:none;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{opacity:.9}.btn[_ngcontent-%COMP%]:disabled{background-color:#b8b1b1;opacity:1;cursor:not-allowed}.input[_ngcontent-%COMP%]{width:100%;padding:0 .5rem;background-color:transparent;border:1px solid #3f51b5;border-radius:4px}.messages[_ngcontent-%COMP%]{max-height:50vh;display:flex;flex-direction:column;gap:.25rem;padding:.5rem;border:1px solid #283593;border-radius:4px;list-style:none;overflow:auto}.messages__item[_ngcontent-%COMP%]{margin-right:2rem;padding:.5rem;width:-moz-fit-content;width:fit-content;display:flex;flex-direction:column;gap:.25rem;border:1px solid #3f51b5;border-radius:4px;background-color:#9cd1f8}.user-messages[_ngcontent-%COMP%]{margin-right:0;margin-left:2rem;align-self:flex-end}.spinner[_ngcontent-%COMP%]{margin-top:1rem;align-self:center}[_nghost-%COMP%]{position:relative;display:flex;flex-direction:column;gap:20px;align-items:center}.error[_ngcontent-%COMP%]{font-size:10px;font-weight:400;line-height:12px;text-align:left;color:red}.edit-btn[_ngcontent-%COMP%]{position:absolute;top:2rem;left:15%}.btn-container[_ngcontent-%COMP%]{display:flex;gap:2rem}.logout-btn[_ngcontent-%COMP%]{position:absolute;top:2rem;right:15%}"]})}return e})()},141:(I,u,i)=>{i.d(u,{S:()=>s});var c=i(5619),p=i(7398),l=i(9397),d=i(4716),t=i(6306),h=i(6232),x=i(2096),v=i(5295),_=i(7188);const P=({name:n,email:a,uid:o,createdAt:r})=>({name:n.S,email:a.S,uid:o.S,createdAt:r.S});var g=i(192),b=i(9392),f=i(9212),m=i(2786),C=i(1474);let O=(()=>{class n{constructor(o){this.http=o}getProfile(){return this.http.get(`${m.w.BASE_URL}${m.w.PROFILE}`)}updateProfileName(o){return this.http.put(`${m.w.BASE_URL}${m.w.PROFILE}`,{name:o})}static#t=this.\u0275fac=function(r){return new(r||n)(f.LFG(C.eN))};static#n=this.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var E=i(2169),M=i(8833),e=i(2072);let s=(()=>{class n{constructor(o,r,T,y,Z){this.http=o,this.store=r,this.notificationService=T,this.authService=y,this.router=Z,this.profile=null,this.subscription=[],this.loading$$=new c.X(!1),this.loading$=this.loading$$.asObservable(),this.profile$=this.store.select(v.t)}getProfile(){return this.profile?this.profile:(this.loading$$.next(!0),this.http.getProfile().pipe((0,p.U)(P),(0,l.b)(o=>this.store.dispatch((0,_.j)({profile:o}))),(0,l.b)(o=>{this.profile=o}),(0,d.x)(()=>this.loading$$.next(!1)),(0,t.K)(o=>(this.notificationService.error(o.error.message||g.T.UNKNOWN_ERROR),"InvalidIDException"===o.error.type&&this.logout(),h.E))).subscribe(),null)}updateProfileName(o){this.loading$$.next(!0);const r={...this.profile,name:o},T=this.http.updateProfileName(o).pipe((0,l.b)(()=>this.store.dispatch((0,_.j)({profile:r}))),(0,l.b)(()=>{this.profile=r}),(0,l.b)(()=>this.notificationService.success(g.T.SUCCESS_PROFILE_NAME)),(0,t.K)(y=>(this.notificationService.error(y.error.message||g.T.UNKNOWN_ERROR),h.E)),(0,d.x)(()=>this.loading$$.next(!1))).subscribe();this.subscription.push(T)}logout(){this.loading$$.next(!0);const o=this.authService.signOut().pipe((0,t.K)(r=>(this.notificationService.error(r.error.message||g.T.UNKNOWN_ERROR),(0,x.of)(null))),(0,l.b)(()=>this.notificationService.success(g.T.SUCCESS_LOGOUT)),(0,l.b)(()=>this.store.dispatch((0,_.j)({profile:{uid:""}}))),(0,l.b)(()=>{this.profile=null}),(0,l.b)(()=>this.router.navigate(["/signin"])),(0,l.b)(()=>b.e.removeCredentials()),(0,d.x)(()=>this.loading$$.next(!1))).subscribe();this.subscription.push(o)}ngOnDestroy(){this.subscription.forEach(o=>o.unsubscribe())}static#t=this.\u0275fac=function(r){return new(r||n)(f.LFG(O),f.LFG(E.yh),f.LFG(M.g),f.LFG(b.e),f.LFG(e.F0))};static#n=this.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},5295:(I,u,i)=>{i.d(u,{t:()=>c});const c=p=>p.profile}}]);