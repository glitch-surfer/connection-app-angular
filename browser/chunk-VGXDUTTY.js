import{a as Y,b as H,c as K,d as u,f as W,g as J,h as Q,j as C,k as X,m as ee,n as te,o as ne,y as O,z as re}from"./chunk-2SKVBX5T.js";import{F as B,H as Z}from"./chunk-S5VQBE6T.js";import{Aa as c,Ca as o,Cb as D,Da as s,Db as L,Ea as d,Fb as q,Hb as G,Ia as V,L as U,Ma as A,O as _,Oa as g,Q as x,Ra as v,Sa as p,U as N,Ua as M,V as T,Va as R,Xa as h,Za as w,_a as S,e as E,eb as y,h as k,la as a,ma as $,mb as j,qb as z,sb as b,v as I,va as l,z as F}from"./chunk-5IAL5MBJ.js";var se=e=>/[a-z]/.test(e)&&/[A-Z]/.test(e),pe=e=>/[0-9]/.test(e)&&/[a-zA-Z]/.test(e),me=e=>/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/.test(e),ie=()=>e=>e.value?.length<8?{weakPassword:"Password must be at least 8 characters long"}:se(e.value)?pe(e.value)?me(e.value)?null:{weakPassword:"Password must contain at least one symbol"}:{weakPassword:"Password must contain at least one number and one letter"}:{weakPassword:"Password must contain at least one uppercase and one lowercase letter"};var P=(()=>{let t=class t{constructor(n,i,m){this.http=n,this.router=i,this.notificationService=m,this.loading$$=new E,this.loading$=this.loading$$.asObservable()}onSubmit(n){if(!n.valid){n.markAllAsTouched();return}let i=n.value;this.loading$$.next(!0),this.http.signUp(i).pipe(I(m=>{if(this.notificationService.error(m.error.message||O.UNKNOWN_ERROR),m.error.type==="PrimaryDuplicationException"){let f=n.get("email");f.setErrors({duplicatedEmail:m.error.message}),t.duplicatedEmail.push(f.value)}return k}),F(()=>this.loading$$.next(!1))).subscribe(()=>{this.router.navigate(["/signin"]),this.notificationService.success(O.SUCCESS_SIGNUP)})}};t.duplicatedEmail=[],t.\u0275fac=function(i){return new(i||t)(_(G),_(D),_(re))},t.\u0275prov=U({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var ae=()=>e=>P.duplicatedEmail.includes(e.value)?{duplicatedEmail:`Email: ${e.value} is already in use`}:null;function ge(e,t){e&1&&d(0,"mat-spinner",2)}function ue(e,t){e&1&&(o(0,"p",17),p(1,"Please enter name"),s())}function fe(e,t){if(e&1&&(o(0,"p",17),p(1),s()),e&2){let r=g(2);a(1),R(" Maximum length is ",r.name==null||r.name.errors==null||r.name.errors.maxlength==null?null:r.name.errors.maxlength.requiredLength,", you entered ",r.name==null||r.name.errors==null||r.name.errors.maxlength==null?null:r.name.errors.maxlength.actualLength," ")}}function _e(e,t){e&1&&(o(0,"p",17),p(1,"Only letters are allowed"),s())}function xe(e,t){e&1&&(o(0,"p",17),p(1,"Please enter email"),s())}function he(e,t){e&1&&(o(0,"p",17),p(1,"The email is invalid"),s())}function be(e,t){if(e&1&&(o(0,"p",17),p(1),s()),e&2){let r=g(2);a(1),M(" ",r.email==null||r.email.errors==null?null:r.email.errors.duplicatedEmail," ")}}function Ce(e,t){e&1&&(o(0,"p",17),p(1," Please enter a password "),s())}function Pe(e,t){if(e&1&&(o(0,"p",17),p(1),s()),e&2){let r=g(3);a(1),M(" Your password isn't strong enough: ",r.password==null||r.password.errors==null?null:r.password.errors.weakPassword," ")}}function ve(e,t){if(e&1&&c(0,Pe,2,1,"p",7),e&2){let r=g(2);l("ngIf",r.hasError("password","weakPassword"))}}function Me(e,t){if(e&1){let r=V();o(0,"form",3),A("ngSubmit",function(){N(r);let i=g();return T(i.onSubmit())}),o(1,"h2"),p(2,"Sign up"),s(),o(3,"div",4),d(4,"label",5)(5,"input",6),c(6,ue,2,0,"p",7)(7,fe,2,2,"p",7)(8,_e,2,0,"p",7),d(9,"label",8)(10,"input",9),c(11,xe,2,0,"p",7)(12,he,2,0,"p",7)(13,be,2,1,"p",7),d(14,"label",10)(15,"input",11),c(16,Ce,2,0,"p",12)(17,ve,1,1,"ng-template",null,13,y),s(),o(19,"div",14)(20,"a",15),p(21,"SignIn"),s(),o(22,"button",16),w(23,"async"),p(24," SignUp "),s()()()}if(e&2){let r=v(18),n=g();l("formGroup",n.form),a(6),l("ngIf",n.hasError("name","required")),a(1),l("ngIf",n.hasError("name","maxlength")),a(1),l("ngIf",n.hasError("name","pattern")),a(3),l("ngIf",n.hasError("email","required")),a(1),l("ngIf",n.hasError("email","email")),a(1),l("ngIf",n.hasError("email","duplicatedEmail")),a(3),l("ngIf",n.hasError("password","required"))("ngIfElse",r),a(4),l("routerLink","/signin"),a(2),l("disabled",!n.form.valid||S(23,11,n.loading$))}}var le=(()=>{let t=class t{constructor(n){this.signUpService=n,this.loading$=this.signUpService.loading$,this.form=new Q({name:new C("",{validators:[u.required,u.maxLength(40),u.pattern(/^[a-zA-Zа-яА-Я ]+$/)]}),email:new C("",{validators:[u.required,u.email,ae()]}),password:new C("",{validators:[u.required,ie()]})})}onSubmit(){this.signUpService.onSubmit(this.form)}hasError(n,i){let m=this.form.get(n);return m?.touched&&m?.errors?.[i]}get password(){return this.form.get("password")}get email(){return this.form.get("email")}get name(){return this.form.get("name")}};t.\u0275fac=function(i){return new(i||t)($(P))},t.\u0275cmp=x({type:t,selectors:[["app-sign-up-form"]],standalone:!0,features:[h],decls:4,vars:4,consts:[["class","spinner",4,"ngIf","ngIfElse"],["content",""],[1,"spinner"],[1,"signup-form",3,"formGroup","ngSubmit"],[1,"container"],["for","name",1,"label"],["type","text","formControlName","name","id","name","placeholder","Vasya",1,"input"],["class","error",4,"ngIf"],["for","email",1,"label"],["type","text","formControlName","email","id","email","placeholder","email@mail.com",1,"input"],["for","password",1,"label"],["type","password","formControlName","password","id","password","placeholder","Password",1,"input"],["class","error",4,"ngIf","ngIfElse"],["weakPassword",""],[1,"btn-container"],[3,"routerLink"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"error"]],template:function(i,m){if(i&1&&(c(0,ge,1,0,"mat-spinner",0),w(1,"async"),c(2,Me,25,13,"ng-template",null,1,y)),i&2){let f=v(3);l("ngIf",S(1,2,m.loading$))("ngIfElse",f)}},dependencies:[b,j,z,ne,X,K,W,J,ee,te,q,L,Z,B,H,Y],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{background-color:#e3f2fd;font-family:Roboto,Helvetica Neue,sans-serif}body.dark-theme[_ngcontent-%COMP%]{background-color:#283593;color:#e3f2fd}a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:visited{color:#3f51b5}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:visited:hover{opacity:.8}a[_ngcontent-%COMP%]:active, a[_ngcontent-%COMP%]:visited:active{opacity:.6}.dark-theme[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .dark-theme[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#e89126}.error-snackbar[_ngcontent-%COMP%]{width:fit-content;color:#3f51b5;background-color:#e3f2fd;border-bottom:3px solid #ff0000}.success-snackbar[_ngcontent-%COMP%]{width:fit-content;color:#3f51b5;background-color:#e3f2fd;border-bottom:3px solid #00ff00}button[_ngcontent-%COMP%]:disabled{color:#757575}.btn[_ngcontent-%COMP%]{height:36px;padding:0 1rem;align-self:flex-start;color:#fafafa;background-color:#424242;border-radius:4px;border:none;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{opacity:.9}.btn[_ngcontent-%COMP%]:disabled{background-color:#b8b1b1;opacity:1;cursor:not-allowed}.input[_ngcontent-%COMP%]{width:100%;padding:0 .5rem;background-color:transparent;border:1px solid #3f51b5;border-radius:4px}.messages[_ngcontent-%COMP%]{max-height:50vh;display:flex;flex-direction:column;gap:.25rem;padding:.5rem;border:1px solid #283593;border-radius:4px;list-style:none;overflow:auto}.messages__item[_ngcontent-%COMP%]{margin-right:2rem;padding:.5rem;width:fit-content;display:flex;flex-direction:column;gap:.25rem;border:1px solid #3f51b5;border-radius:4px;background-color:#9cd1f8}.user-messages[_ngcontent-%COMP%]{margin-right:0;margin-left:2rem;align-self:flex-end}.spinner[_ngcontent-%COMP%]{margin-top:1rem;align-self:center}[_nghost-%COMP%]{margin-top:45px;display:flex;flex-direction:column;gap:20px;align-items:center}.signup-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:20px;width:350px;border-radius:4px}.title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;line-height:21px;text-align:left}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.label[_ngcontent-%COMP%]{font-size:10px;font-weight:400;line-height:12px;text-align:left}.input[_ngcontent-%COMP%]{width:100%;padding:13px 8px;background-color:transparent;border:1px solid #3f51b5;border-radius:4px}.error[_ngcontent-%COMP%]{font-size:10px;font-weight:400;line-height:12px;text-align:left;color:red}.dark-theme[_nghost-%COMP%]   a[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   a[_ngcontent-%COMP%], .dark-theme[_nghost-%COMP%]   a[_ngcontent-%COMP%]:visited, .dark-theme   [_nghost-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#e89126}.dark-theme[_nghost-%COMP%]   .input[_ngcontent-%COMP%], .dark-theme   [_nghost-%COMP%]   .input[_ngcontent-%COMP%]{color:#e3f2fd;border-color:#e89126}"]});let e=t;return e})();var Be=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=x({type:t,selectors:[["app-sign-up"]],standalone:!0,features:[h],decls:1,vars:0,template:function(i,m){i&1&&d(0,"app-sign-up-form")},dependencies:[b,le]});let e=t;return e})();export{Be as SignUpComponent};
